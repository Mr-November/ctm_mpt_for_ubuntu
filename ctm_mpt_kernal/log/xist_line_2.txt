smp = 46;
R0 = rot([1;0;0], 50/180*pi);
[x, y, z] = path_line([-0.2; -0.2; 2.5], R0, [0.4; 0.4; 0], smp);
rs = [x; y; z];
qs = nan(4, smp);
for smp_idx = 1: smp
    Rc = expm(up_hat([1;0;0]) * (-(z(smp_idx)-2.5)./max(z-2.5).*15 + 10)/180*pi);
    qs(:, smp_idx) = rot2q(R0 * Rc);
end



cost = 0.3290



-0.783869296723138,-0.300782504733637,1.30009366041955,0.365730350383387,0.535707145342689,-0.0949623355218361
-0.759108131213935,-0.290204655765835,1.22160978250681,0.349933127100788,0.551334774570221,-0.0845552449460357
-0.7302145912971,-0.279301014571803,1.13648078683104,0.333144806753217,0.569536693177443,-0.0738973316336132
-0.696562918843668,-0.267936085853845,1.04338710472662,0.315106596988178,0.591001464793602,-0.0628367537455538
-0.657233232109823,-0.255925073765392,0.940416954460624,0.295455212651523,0.616715759498972,-0.0511659863587197
-0.610796077671488,-0.242997587152512,0.824632125326291,0.273646921027551,0.648182768563051,-0.038580349932635
-0.554821846853412,-0.228714736017541,0.691078272432806,0.248783841289325,0.687920503719958,-0.0245829449069812
-0.48470813717813,-0.212279484382445,0.530420219955045,0.219214393356665,0.740652037165693,-0.00826433374486556
-0.493388741747878,-0.180080888883436,0.547631281328183,0.187013088236032,0.731342278003921,-0.00827032532034342
-0.502065107696609,-0.146832785912809,0.565192520516693,0.153359600733795,0.72241451755519,-0.00779974712337894
-0.5089881120821,-0.11297001073004,0.579204001561224,0.118523347540751,0.715276422592197,-0.00664298319567762
-0.514031580014105,-0.0786219192157703,0.58941048529794,0.0827527463067225,0.710068047255947,-0.00494553672611626
-0.517248798389214,-0.0439420954337883,0.595920814688566,0.0463449769798434,0.706742019112149,-0.00287833850178844
-0.518614194804795,-0.00907764835016397,0.598683405501542,0.00958289594773071,0.705329650065126,-0.000605281336224592
-0.518161826829362,0.0258251570664456,0.597768087323445,-0.0272526862999702,0.705797448632666,0.0017104309039793
-0.515908467747672,0.060618522068811,0.59320828269403,-0.0638783529367087,0.708128059432884,0.003904372730858
-0.511789573707184,0.0951548677699544,0.584873112194674,-0.100010188869723,0.712384055640782,0.00581157041425617
-0.505918986724246,0.129296372293604,0.57299268778145,-0.135384236252753,0.718442513022892,0.00727862290809499
-0.498165696564805,0.162884114222982,0.557300567456124,-0.169691759606004,0.726429347078316,0.00812876941471123
-0.488591603350328,0.195779597909807,0.537921855748042,-0.202664357001443,0.736269310970003,0.00820729585277443
-0.520597676963008,0.220518098275123,0.611871032865963,-0.23416383277205,0.713238197767848,0.016479642136173
-0.583101990983219,0.235779127601779,0.757853487396492,-0.261180717131694,0.667585224148753,0.0315226988962114
-0.634093091305729,0.249339137080036,0.882053822968859,-0.284428762785481,0.632235486226314,0.0447604408966483
-0.676894795584477,0.261785442136227,0.991229385314443,-0.30511801523516,0.603763417297152,0.0568603654524564
-0.713358986421211,0.273459036257469,1.0891693977003,-0.323940791731696,0.580237615312159,0.0682075452212229
-0.744633511044966,0.28458311161938,1.17824484989275,-0.341341385172459,0.560440301799241,0.0790530446489255
-0.771478571933224,0.295315655558927,1.26004599242615,-0.357626355757112,0.543546635067494,0.089574083926503
-0.788441819400114,0.278408720751346,1.30938848276123,-0.338895974609823,0.530336934840278,0.0885544721303359
-0.796849305941597,0.231234977026592,1.32646093648052,-0.282032759239308,0.520442621385399,0.0745456349155433
-0.803712844201513,0.18340587533186,1.34038073402321,-0.224054014388073,0.512346197483676,0.0597669052800772
-0.809112254264381,0.135052374482211,1.3512881217728,-0.165176886256237,0.50601490323147,0.0443836578824326
-0.812680875425948,0.0863084819726975,1.35854454875611,-0.105654148098643,0.501741879323415,0.0285164984486252
-0.814740242279435,0.0373153345204869,1.36271168944721,-0.0457006867603094,0.499302581634939,0.0123677196487139
-0.815208056205488,-0.0117883194045055,1.36364559623488,0.0144430978984756,0.498767785768616,-0.00391100280282104
-0.81395483177295,-0.0608543517416666,1.36112250631516,0.0745158158909495,0.500233022222649,-0.0201454298463894
-0.81123353562826,-0.109747920063519,1.35558026226321,0.1342921285406,0.503508768072122,-0.0361875010755892
-0.806783536621756,-0.158318859203587,1.3465703826836,0.193529385420141,0.508770821788608,-0.0518433693438946
-0.800613312776036,-0.206437508369531,1.33409660339517,0.25200903272616,0.516004602958143,-0.0669472903270141
-0.793004079969154,-0.253967982164464,1.31865562450914,0.309479821038491,0.524971075637932,-0.0813750809530054
-0.783869296723138,-0.300782504733637,1.30009366041955,0.365730350383387,0.535707145342689,-0.0949623355218361






0,2.34083182354011,4.78785776462602,7.37087197700675,10.1324520603922,13.1373474410148,16.4938966419385,20.4052327154071,21.8546787596621,23.3513692389485,25.3838498394423,27.4454596540526,29.5269804002107,31.6195824377562,33.7144867841716,35.8028223978809,37.8757314335596,39.9249416722792,41.9409144777388,43.9153371904806,48.5994191692688,57.8894547097289,66.024790265363,73.3901983840539,80.2027829944509,86.5995993867564,92.6736277643236,96.1547946344668,101.356444238603,106.630357399877,115.337046551528,124.114030899393,132.935896905616,141.777661067937,150.612650964384,159.416586427446,168.162428227221,176.826829218329,185.38532143278,193.814897133206




cost = 0.5241



0.845760539347654,-0.0384725774123625,-2.02558909082355,-0.209174743711174,2.22518251101769,0.25722987730372
0.782384071777494,-0.0428072963309251,-1.9205235122727,-0.190166759242415,2.14619637425901,0.242724839576415
0.716462807133792,-0.0475440558305858,-1.80899489064384,-0.170821366230145,2.06330300900526,0.228211989555844
0.64726279396674,-0.0528085099377126,-1.68959033170791,-0.150853653560227,1.97582392270835,0.213531976293498
0.573797130446671,-0.0587763884146031,-1.56039826682491,-0.129880356519974,1.88283399390663,0.19847770237318
0.494572573790977,-0.065708661843736,-1.41848200041536,-0.107340792830148,1.78289034942009,0.182744925033024
0.407109203109523,-0.0740319908888628,-1.25891129349173,-0.082327926899316,1.67354500824859,0.16583968256706
0.306796410310911,-0.0845256607343283,-1.07245309842373,-0.0531864549531514,1.55018222598728,0.146846617901118
0.310642797983552,-0.0706067827872606,-1.08127039972431,-0.0463545035033177,1.55487825923939,0.124643921350423
0.315793419519796,-0.0565955472489422,-1.09231330296939,-0.0389664721562792,1.56116645734949,0.101772866690188
0.319776827217988,-0.042961975187056,-1.1008777783887,-0.0306653538495711,1.56605961015488,0.0783722553533836
0.322759838934465,-0.0296016475446436,-1.10729086560234,-0.0216994201603151,1.56971816782845,0.0545864913016237
0.324606235267709,-0.0164414656964889,-1.11127050589516,-0.0122493621772862,1.57199688455487,0.0305211905535667
0.32546012178923,-0.00338670762473386,-1.11310380186717,-0.00254211718252271,1.57303905263798,0.00630644266794015
0.325205336117124,0.00964415962995992,-1.1125547172266,0.00722293003482057,1.57272493499449,-0.0179419649791145
0.323887581558607,0.0227384355905522,-1.10971578202238,0.0168338066996668,1.57110130052966,-0.0421010573908136
0.321462578735839,0.0359855709936016,-1.1045010474356,0.0260739560422481,1.56812626336273,-0.0660452798882866
0.317975955974761,0.0494685197238049,-1.09700743110459,0.0347414706899928,1.56385085662586,-0.0896573211954639
0.313399796722148,0.0632768003934975,-1.08718667200975,0.0426209965385318,1.55825411060425,-0.112813157835743
0.307763896345471,0.0774922601114866,-1.07510875886514,0.0495142022716861,1.551375556787,-0.135397974975381
0.356968809689287,0.0791483658466161,-1.16614921507101,0.0678398107930062,1.61156681108778,-0.156310435783303
0.450340206635845,0.0698255894398855,-1.33814866397231,0.0947223263705204,1.72742362817706,-0.174143890943358
0.533444267330501,0.062239122375771,-1.48843766718115,0.11840156083379,1.83185370989195,-0.190406530763063
0.609672049284837,0.0558100956667167,-1.62378651840092,0.14010312987639,1.92823243670341,-0.205766778680098
0.680941701426932,0.0502060715814265,-1.74799069611982,0.160537000995252,2.01843577712595,-0.22061065922947
0.748466229796714,0.0452132163431985,-1.86341979498361,0.18016571031513,2.10362028392456,-0.235188739063445
0.813074424200532,0.0406823714422386,-1.97166456207632,0.199317457263005,2.18454862554159,-0.249677520807041
0.847986923582835,0.0350985248776245,-2.03131609489567,0.19424800956394,2.22896867044258,-0.238141823132568
0.852008765344758,0.0284312628263777,-2.04167340567156,0.162222616563996,2.23581267066337,-0.197824230542536
0.855216528978773,0.0221164697002235,-2.04995221288561,0.129197450110489,2.24128569569546,-0.15690200823689
0.85773528515285,0.016026705894524,-2.05647362100878,0.0954530536464093,2.24558971997267,-0.115545419391601
0.859484467876626,0.0101277399518687,-2.06101201462914,0.0611426553144757,2.24858538192873,-0.0738462721257938
0.860518639013588,0.00434523599572666,-2.06371317627589,0.0264770611180524,2.25036613960105,-0.0319329806567086
0.860719855307575,-0.00137074220932189,-2.0642362567011,-0.00836546837873692,2.2507113668264,0.0100866868860497
0.860147326015121,-0.00710330010809237,-2.06274815431074,-0.0431585095659832,2.24972920718447,0.0520765096497274
0.858803083490453,-0.0129213587494996,-2.05925715379511,-0.0776963875570401,2.24742477373256,0.0939124181594688
0.856628479716749,-0.0189210509516073,-2.05360179907666,-0.111736752028152,2.24369058282482,0.135447101881435
0.853746638280396,-0.0251187014148022,-2.04614907594978,-0.145157636753246,2.23877273189307,0.176610889944712
0.850110527939951,-0.0316167154517315,-2.03676880622546,-0.1776937777986,2.23257601863774,0.217238010676782
0.845789239704196,-0.0384364556212131,-2.02567233532656,-0.209218264269504,2.22523869134425,0.257250825768485


0,2.5682869061056,5.24483141148567,8.06107470527727,11.0594463067723,14.3040339488601,17.9011201897342,22.0479889275849,23.0023041389476,23.9982345978374,25.3294233432753,26.6590691757744,27.978109881806,29.2820238421139,30.5617032295646,31.8110775806012,33.0221225325726,34.1951677811388,35.3946884672191,36.6137780923951,41.5393234542635,50.9696266765864,59.3237437575856,66.9574115563779,74.0721280557765,80.7955160741256,87.2149427477488,90.8566944550479,94.6269399501402,98.5119419367678,105.005541587152,111.637357387363,118.378680181022,125.221524687201,132.135008817331,139.095608206917,146.084913713088,153.070032036242,160.028527453402,166.933779975786




cost = 4.7911


0.845760539347654,-0.0384725774123625,-2.02558909082355,-0.209174743711174,2.22518251101769,0.25722987730372
0.782384071777494,-0.0428072963309251,-1.9205235122727,-0.190166759242415,2.14619637425901,0.242724839576415
0.716462807133792,-0.0475440558305858,-1.80899489064384,-0.170821366230145,2.06330300900526,0.228211989555844
0.64726279396674,-0.0528085099377126,-1.68959033170791,-0.150853653560227,1.97582392270835,0.213531976293498
0.573797130446671,-0.0587763884146031,-1.56039826682491,-0.129880356519974,1.88283399390663,0.19847770237318
0.494572573790977,-0.065708661843736,-1.41848200041536,-0.107340792830148,1.78289034942009,0.182744925033024
0.407109203109523,-0.0740319908888628,-1.25891129349173,-0.082327926899316,1.67354500824859,0.16583968256706
0.306796410310911,-0.0845256607343283,-1.07245309842373,-0.0531864549531514,1.55018222598728,0.146846617901118
0.310642797983552,-0.0706067827872606,-1.08127039972431,-0.0463545035033177,1.55487825923939,0.124643921350423
0.315793419519796,-0.0565955472489422,-1.09231330296939,-0.0389664721562792,1.56116645734949,0.101772866690188
0.319776827217988,-0.042961975187056,-1.1008777783887,-0.0306653538495711,1.56605961015488,0.0783722553533836
0.322759838934465,-0.0296016475446436,-1.10729086560234,-0.0216994201603151,1.56971816782845,0.0545864913016237
0.324606235267709,-0.0164414656964889,-1.11127050589516,-0.0122493621772862,1.57199688455487,0.0305211905535667
0.32546012178923,-0.00338670762473386,-1.11310380186717,-0.00254211718252271,1.57303905263798,0.00630644266794015
0.325205336117124,0.00964415962995992,-1.1125547172266,0.00722293003482057,1.57272493499449,-0.0179419649791145
0.323887581558607,0.0227384355905522,-1.10971578202238,0.0168338066996668,1.57110130052966,-0.0421010573908136
0.321462578735839,0.0359855709936016,-1.1045010474356,0.0260739560422481,1.56812626336273,-0.0660452798882866
0.317975955974761,0.0494685197238049,-1.09700743110459,0.0347414706899928,1.56385085662586,-0.0896573211954639
0.313399796722148,0.0632768003934975,-1.08718667200975,0.0426209965385318,1.55825411060425,-0.112813157835743
0.307763896345471,0.0774922601114866,-1.07510875886514,0.0495142022716861,1.551375556787,-0.135397974975381
-0.520597676963008,0.220518098275123,0.611871032865963,-0.23416383277205,0.713238197767848,0.016479642136173
-0.583101990983219,0.235779127601779,0.757853487396492,-0.261180717131694,0.667585224148753,0.0315226988962114
-0.634093091305729,0.249339137080036,0.882053822968859,-0.284428762785481,0.632235486226314,0.0447604408966483
-0.676894795584477,0.261785442136227,0.991229385314443,-0.30511801523516,0.603763417297152,0.0568603654524564
-0.713358986421211,0.273459036257469,1.0891693977003,-0.323940791731696,0.580237615312159,0.0682075452212229
-0.744633511044966,0.28458311161938,1.17824484989275,-0.341341385172459,0.560440301799241,0.0790530446489255
-0.771478571933224,0.295315655558927,1.26004599242615,-0.357626355757112,0.543546635067494,0.089574083926503
-0.788441819400114,0.278408720751346,1.30938848276123,-0.338895974609823,0.530336934840278,0.0885544721303359
-0.796849305941597,0.231234977026592,1.32646093648052,-0.282032759239308,0.520442621385399,0.0745456349155433
-0.803712844201513,0.18340587533186,1.34038073402321,-0.224054014388073,0.512346197483676,0.0597669052800772
-0.809112254264381,0.135052374482211,1.3512881217728,-0.165176886256237,0.50601490323147,0.0443836578824326
-0.812680875425948,0.0863084819726975,1.35854454875611,-0.105654148098643,0.501741879323415,0.0285164984486252
-0.814740242279435,0.0373153345204869,1.36271168944721,-0.0457006867603094,0.499302581634939,0.0123677196487139
-0.815208056205488,-0.0117883194045055,1.36364559623488,0.0144430978984756,0.498767785768616,-0.00391100280282104
-0.81395483177295,-0.0608543517416666,1.36112250631516,0.0745158158909495,0.500233022222649,-0.0201454298463894
-0.81123353562826,-0.109747920063519,1.35558026226321,0.1342921285406,0.503508768072122,-0.0361875010755892
-0.806783536621756,-0.158318859203587,1.3465703826836,0.193529385420141,0.508770821788608,-0.0518433693438946
-0.800613312776036,-0.206437508369531,1.33409660339517,0.25200903272616,0.516004602958143,-0.0669472903270141
-0.793004079969154,-0.253967982164464,1.31865562450914,0.309479821038491,0.524971075637932,-0.0813750809530054
-0.783869296723138,-0.300782504733637,1.30009366041955,0.365730350383387,0.535707145342689,-0.0949623355218361



0,2.5682869061056,5.24483141148567,8.06107470527727,11.0594463067723,14.3040339488601,17.9011201897342,22.0479889275849,23.0023041389476,23.9982345978374,25.3294233432753,26.6590691757744,27.978109881806,29.2820238421139,30.5617032295646,31.8110775806012,33.0221225325726,34.1951677811388,35.3946884672191,36.6137780923951,132.544771697139,141.834807237599,149.970142793233,157.335550911924,164.148135522321,170.544951914627,176.618980292194,180.100147162337,185.301796766473,190.575709927748,199.282399079399,208.059383427264,216.881249433487,225.723013595807,234.558003492255,243.361938955316,252.107780755092,260.772181746199,269.33067396065,277.760249661077




cost = 4.8956


-0.783869296723138,-0.300782504733637,1.30009366041955,0.365730350383387,0.535707145342689,-0.0949623355218361
-0.759108131213935,-0.290204655765835,1.22160978250681,0.349933127100788,0.551334774570221,-0.0845552449460357
-0.7302145912971,-0.279301014571803,1.13648078683104,0.333144806753217,0.569536693177443,-0.0738973316336132
-0.696562918843668,-0.267936085853845,1.04338710472662,0.315106596988178,0.591001464793602,-0.0628367537455538
-0.657233232109823,-0.255925073765392,0.940416954460624,0.295455212651523,0.616715759498972,-0.0511659863587197
-0.610796077671488,-0.242997587152512,0.824632125326291,0.273646921027551,0.648182768563051,-0.038580349932635
-0.554821846853412,-0.228714736017541,0.691078272432806,0.248783841289325,0.687920503719958,-0.0245829449069812
-0.48470813717813,-0.212279484382445,0.530420219955045,0.219214393356665,0.740652037165693,-0.00826433374486556
-0.493388741747878,-0.180080888883436,0.547631281328183,0.187013088236032,0.731342278003921,-0.00827032532034342
-0.502065107696609,-0.146832785912809,0.565192520516693,0.153359600733795,0.72241451755519,-0.00779974712337894
-0.5089881120821,-0.11297001073004,0.579204001561224,0.118523347540751,0.715276422592197,-0.00664298319567762
-0.514031580014105,-0.0786219192157703,0.58941048529794,0.0827527463067225,0.710068047255947,-0.00494553672611626
-0.517248798389214,-0.0439420954337883,0.595920814688566,0.0463449769798434,0.706742019112149,-0.00287833850178844
-0.518614194804795,-0.00907764835016397,0.598683405501542,0.00958289594773071,0.705329650065126,-0.000605281336224592
-0.518161826829362,0.0258251570664456,0.597768087323445,-0.0272526862999702,0.705797448632666,0.0017104309039793
-0.515908467747672,0.060618522068811,0.59320828269403,-0.0638783529367087,0.708128059432884,0.003904372730858
-0.511789573707184,0.0951548677699544,0.584873112194674,-0.100010188869723,0.712384055640782,0.00581157041425617
-0.505918986724246,0.129296372293604,0.57299268778145,-0.135384236252753,0.718442513022892,0.00727862290809499
-0.498165696564805,0.162884114222982,0.557300567456124,-0.169691759606004,0.726429347078316,0.00812876941471123
-0.488591603350328,0.195779597909807,0.537921855748042,-0.202664357001443,0.736269310970003,0.00820729585277443
0.356968809689287,0.0791483658466161,-1.16614921507101,0.0678398107930062,1.61156681108778,-0.156310435783303
0.450340206635845,0.0698255894398855,-1.33814866397231,0.0947223263705204,1.72742362817706,-0.174143890943358
0.533444267330501,0.062239122375771,-1.48843766718115,0.11840156083379,1.83185370989195,-0.190406530763063
0.609672049284837,0.0558100956667167,-1.62378651840092,0.14010312987639,1.92823243670341,-0.205766778680098
0.680941701426932,0.0502060715814265,-1.74799069611982,0.160537000995252,2.01843577712595,-0.22061065922947
0.748466229796714,0.0452132163431985,-1.86341979498361,0.18016571031513,2.10362028392456,-0.235188739063445
0.813074424200532,0.0406823714422386,-1.97166456207632,0.199317457263005,2.18454862554159,-0.249677520807041
0.847986923582835,0.0350985248776245,-2.03131609489567,0.19424800956394,2.22896867044258,-0.238141823132568
0.852008765344758,0.0284312628263777,-2.04167340567156,0.162222616563996,2.23581267066337,-0.197824230542536
0.855216528978773,0.0221164697002235,-2.04995221288561,0.129197450110489,2.24128569569546,-0.15690200823689
0.85773528515285,0.016026705894524,-2.05647362100878,0.0954530536464093,2.24558971997267,-0.115545419391601
0.859484467876626,0.0101277399518687,-2.06101201462914,0.0611426553144757,2.24858538192873,-0.0738462721257938
0.860518639013588,0.00434523599572666,-2.06371317627589,0.0264770611180524,2.25036613960105,-0.0319329806567086
0.860719855307575,-0.00137074220932189,-2.0642362567011,-0.00836546837873692,2.2507113668264,0.0100866868860497
0.860147326015121,-0.00710330010809237,-2.06274815431074,-0.0431585095659832,2.24972920718447,0.0520765096497274
0.858803083490453,-0.0129213587494996,-2.05925715379511,-0.0776963875570401,2.24742477373256,0.0939124181594688
0.856628479716749,-0.0189210509516073,-2.05360179907666,-0.111736752028152,2.24369058282482,0.135447101881435
0.853746638280396,-0.0251187014148022,-2.04614907594978,-0.145157636753246,2.23877273189307,0.176610889944712
0.850110527939951,-0.0316167154517315,-2.03676880622546,-0.1776937777986,2.23257601863774,0.217238010676782
0.845789239704196,-0.0384364556212131,-2.02567233532656,-0.209218264269504,2.22523869134425,0.257250825768485


0,2.34083182354011,4.78785776462602,7.37087197700675,10.1324520603922,13.1373474410148,16.4938966419385,20.4052327154071,21.8546787596621,23.3513692389485,25.3838498394423,27.4454596540526,29.5269804002107,31.6195824377562,33.7144867841716,35.8028223978809,37.8757314335596,39.9249416722792,41.9409144777388,43.9153371904806,140.087794178305,149.518097400628,157.872214481627,165.505882280419,172.620598779818,179.343986798167,185.76341347179,189.40516517909,193.175410674182,197.060412660809,203.554012311194,210.185828111405,216.927150905064,223.769995411242,230.683479541372,237.644078930958,244.633384437129,251.618502760284,258.576998177444,265.482250699828
